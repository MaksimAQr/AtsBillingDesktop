<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:ATS_Desktop.ViewModels"
             x:Class="ATS_Desktop.Views.Components.AddTariffForm"
             x:Name="Self"
             x:DataType="vm:TariffViewModel">
    
    <Border Background="#2C3E50" 
            CornerRadius="8" 
            Padding="20"
            IsVisible="{Binding ShowAddTariffForm}"
            Margin="0,50,0,0">
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/> 
                <RowDefinition Height="Auto"/> 
                <RowDefinition Height="Auto"/> 
                <RowDefinition Height="Auto"/> 
                <RowDefinition Height="Auto"/> 
                <RowDefinition Height="Auto"/> 
                <RowDefinition Height="Auto"/> 
            </Grid.RowDefinitions>
            <TextBlock Margin="0,0,0,10"
                       Grid.Row="0"
                       Text="Добавление нового тарифа" 
                       Foreground="White" 
                       FontSize="20" 
                       FontWeight="Bold"/>
            
            <!-- Название тарифа -->
            <StackPanel Margin="0,0,0,10"
                        Grid.Row="1">
                <TextBlock Text="Название тарифа" 
                           Foreground="#BDC3C7" 
                           FontSize="12"/>
                <TextBox Text="{Binding TariffEditVM.Name}" 
                         Watermark="Введите название"
                         Background="#34495E" 
                         Foreground="White"
                         Padding="10" 
                         FontSize="14"/>
            </StackPanel>
            
            <!-- Стоимость -->
            <StackPanel Margin="0,0,0,10"
                        Grid.Row="2">
                <TextBlock Text="Стоимость за минуту ($)" 
                           Foreground="#BDC3C7" 
                           FontSize="12"/>
                <TextBox Text="{Binding TariffEditVM.Cost}" 
                         Watermark="0.00"
                         Background="#34495E" 
                         Foreground="White"
                         Padding="10" 
                         FontSize="14">
                        <TextBox.Styles>
                            <Style Selector="TextBox:error">
                                <Setter Property="BorderBrush" Value="#E74C3C"/>
                            </Style>
                        </TextBox.Styles>
                </TextBox>
                <TextBlock 
                    Text="{Binding TariffEditVM.CostError}" 
                    Foreground="#E74C3C"
                    FontSize="12"
                    TextWrapping="Wrap"
                    IsVisible="{Binding TariffEditVM.HasCostError}"/>
            </StackPanel>
            
            <!-- Кнопка добавления описания -->
                <Button Margin="0,0,0,10"
                        Grid.Row="3"
                        Command="{Binding ToggleDescriptionCommand}"
                        Background="#3498DB"
                        Foreground="White"
                        Padding="10"
                        HorizontalAlignment="Left"
                        CornerRadius="5">
                    <TextBlock Text="Добавить описание"/>
                </Button>
            
            <!-- Поле описания -->
            <Border Margin="0,0,0,10"
                    Grid.Row="4"
                    IsVisible="{Binding TariffEditVM.ShowDescriptionField}"
                    Background="#34495E"
                    CornerRadius="5"
                    Padding="15">
                <StackPanel Spacing="10">
                    <TextBlock Text="Описание тарифа" 
                               Foreground="#BDC3C7" 
                               FontSize="12"/>
                    <TextBox Text="{Binding TariffEditVM.Description}" 
                             Watermark="Введите описание тарифа (необязательно)"
                             Background="#2C3E50" 
                             Foreground="White"
                             Padding="10"
                             AcceptsReturn="True"
                             TextWrapping="Wrap"
                             Height="80"
                             FontSize="14"/>
                    <TextBlock Text="{Binding TariffEditVM.Description, 
                                       StringFormat='Символов: {0}'}"
                               Foreground="#7F8C8D"
                               FontSize="11"
                               HorizontalAlignment="Right"/>
                </StackPanel>
            </Border>
            
            <!-- Тип тарифа -->
            <Border Margin="0,0,0,10"
                    Grid.Row="5"
                    Background="#34495E" 
                    CornerRadius="5" 
                    Padding="15">
                <StackPanel Spacing="10">
                    <TextBlock Text="Тип тарифа" 
                               Foreground="White" 
                               FontSize="14" 
                               FontWeight="Bold"/>
                    <StackPanel Orientation="Horizontal" 
                                Spacing="20">
                        <RadioButton Content="Обычный" 
                                     IsChecked="{Binding TariffEditVM.IsPreferential, Converter={x:Static BoolConverters.Not}}"
                                     Foreground="White"/>
                        <RadioButton Content="Льготный" 
                                     IsChecked="{Binding TariffEditVM.IsPreferential}"
                                     Foreground="White"/>
                    </StackPanel>
                    
                    <!-- Поле скидки -->
                    <StackPanel IsVisible="{Binding TariffEditVM.IsPreferential}">
                        <TextBlock Text="Скидка (%)" 
                                   Foreground="#BDC3C7" 
                                   FontSize="12"/>
                        <Slider Minimum="1" 
                                Maximum="100" 
                                Value="{Binding TariffEditVM.Discount}"
                                Background="#2C3E50"/>
                        <TextBlock Text="{Binding TariffEditVM.Discount, StringFormat='{}{0}%'}" 
                                   Foreground="#2ECC71" 
                                   FontSize="12" 
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </StackPanel>
            </Border>
            
            <StackPanel Margin="0,0,0,10"
                        Grid.Row="6"
                        Orientation="Horizontal" 
                        Spacing="10" 
                        HorizontalAlignment="Right">
                <Button Content="Отмена" 
                        Command="{Binding CancelAddTariffCommand}"
                        Background="#95A5A6" 
                        Foreground="White"
                        Padding="20,10"/>
                
                <Button Content="Добавить" 
                        Command="{Binding AddTariffCommand}"
                        Background="#27AE60" 
                        Foreground="White"
                        Padding="20,10"/>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>